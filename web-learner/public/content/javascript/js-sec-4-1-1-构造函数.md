## æ„é€ å‡½æ•°

### ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ
æ„é€ å‡½æ•°å°±åƒä¸€ä¸ªâ€œå¯¹è±¡è“å›¾â€ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„ç»“æ„å’Œè¡Œä¸ºï¼Œå¿«é€Ÿã€é‡å¤åœ°åˆ›å»ºå¤šä¸ªç›¸ä¼¼çš„å¯¹è±¡å®ä¾‹ã€‚

### ğŸ“š Level 1: åŸºç¡€è®¤çŸ¥ï¼ˆ30ç§’ç†è§£ï¼‰
æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªæ¸¸æˆè§’è‰²ã€‚ä½¿ç”¨æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªâ€œç©å®¶â€æ¨¡æ¿ï¼Œç„¶åç”¨å®ƒæ¥åˆ›å»ºå…·ä½“çš„ç©å®¶ã€‚

```javascript
// å®šä¹‰ä¸€ä¸ªç©å®¶æ„é€ å‡½æ•° (è“å›¾)
// æŒ‰ç…§æƒ¯ä¾‹ï¼Œæ„é€ å‡½æ•°åé¦–å­—æ¯å¤§å†™
function Player(name, level) {
  this.name = name;
  this.level = level;
}

// ä½¿ç”¨ new å…³é”®å­—ï¼Œæ ¹æ®è“å›¾åˆ›å»ºä¸€ä¸ªå…·ä½“çš„ç©å®¶å¯¹è±¡
const player1 = new Player('å‹‡è€…çˆ±ä¸½ä¸', 99);

// æŸ¥çœ‹æˆ‘ä»¬åˆ›å»ºçš„ç©å®¶
console.log('æ–°ç©å®¶å·²åˆ›å»º:', player1);
console.log(`ç©å®¶åç§°: ${player1.name}`);
console.log(`ç©å®¶ç­‰çº§: ${player1.level}`);
```

### ğŸ“ˆ Level 2: æ ¸å¿ƒç‰¹æ€§ï¼ˆæ·±å…¥ç†è§£ï¼‰
æ„é€ å‡½æ•°æœ‰ä¸¤ä¸ªæ ¸å¿ƒç‰¹æ€§ï¼š`new`å…³é”®å­—çš„èƒŒåæœºåˆ¶å’Œå…±äº«æ–¹æ³•çš„å®ç°ã€‚

#### ç‰¹æ€§1: `new` å…³é”®å­—çš„é­”æ³•
å½“ä½ ä½¿ç”¨ `new` å…³é”®å­—æ—¶ï¼ŒJavaScript åœ¨èƒŒåé»˜é»˜ä¸ºä½ åšäº†å››ä»¶äº‹ï¼š
1.  åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ç©ºå¯¹è±¡ã€‚
2.  å°†è¿™ä¸ªæ–°å¯¹è±¡çš„åŸå‹ (`__proto__`) é“¾æ¥åˆ°æ„é€ å‡½æ•°çš„ `prototype` å±æ€§ã€‚
3.  å°†æ„é€ å‡½æ•°å†…éƒ¨çš„ `this` å…³é”®å­—ç»‘å®šåˆ°è¿™ä¸ªæ–°å¯¹è±¡ä¸Šã€‚
4.  å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰æ˜¾å¼è¿”å›å…¶ä»–å¯¹è±¡ï¼Œé‚£ä¹ˆå°±è‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°åˆ›å»ºçš„å¯¹è±¡ã€‚

```javascript
function Monster(name, hp) {
  console.log(`(1) ä¸€ä¸ªæ–°çš„æ€ªå…½å¯¹è±¡æ­£åœ¨åˆ›å»º... this æŒ‡å‘å®ƒ`);
  this.name = name;
  this.hp = hp;
  // (2) ç”±äºæ²¡æœ‰ return è¯­å¥ï¼Œå‡½æ•°ä¼šè‡ªåŠ¨è¿”å› this
  console.log(`(3) æ€ªå…½ ${this.name} åˆ›å»ºå®Œæ¯•!`);
}

// ä½¿ç”¨ new è°ƒç”¨æ„é€ å‡½æ•°
console.log('--- å¼€å§‹å¬å”¤æ€ªå…½ ---');
const slime = new Monster('å²è±å§†', 50);

// slime å°±æ˜¯æ„é€ å‡½æ•°è¿”å›çš„æ–°å¯¹è±¡
console.log('--- å¬å”¤æˆåŠŸ ---');
console.log('å¬å”¤å‡ºçš„æ€ªå…½:', slime);
console.log(`å®ƒçš„åå­—æ˜¯ ${slime.name}ï¼Œç”Ÿå‘½å€¼æ˜¯ ${slime.hp}`);
```

#### ç‰¹æ€§2: ä½¿ç”¨åŸå‹ï¼ˆprototypeï¼‰å…±äº«æ–¹æ³•
å¦‚æœæ¯ä¸ªæ€ªå…½éƒ½æœ‰ä¸€ä¸ª `attack` æ–¹æ³•ï¼Œç›´æ¥åœ¨æ„é€ å‡½æ•°é‡Œå®šä¹‰ï¼ˆ`this.attack = ...`ï¼‰ä¼šä¸ºæ¯ä¸ªå®ä¾‹éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæµªè´¹å†…å­˜ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯æŠŠå…±äº«çš„æ–¹æ³•æ”¾åœ¨ `prototype` ä¸Šã€‚

```javascript
function Robot(model) {
  // æ¯ä¸ªæœºå™¨äººå®ä¾‹ç‹¬æœ‰çš„å±æ€§
  this.model = model;
  this.energy = 100;
}

// å°†å…±äº«çš„æ–¹æ³•å®šä¹‰åœ¨åŸå‹ä¸Š
// æ‰€æœ‰ Robot å®ä¾‹éƒ½èƒ½è®¿é—®è¿™ä¸ª sayHello æ–¹æ³•ï¼Œä½†å®ƒåªåœ¨å†…å­˜ä¸­å­˜åœ¨ä¸€ä»½
Robot.prototype.sayHello = function() {
  console.log(`ä½ å¥½ï¼Œæˆ‘æ˜¯ ${this.model} å‹å·æœºå™¨äººã€‚`);
};

const robotA = new Robot('T-800');
const robotB = new Robot('R2-D2');

robotA.sayHello();
robotB.sayHello();

// éªŒè¯ä¸¤ä¸ªå®ä¾‹æ˜¯å¦å…±äº«åŒä¸€ä¸ªæ–¹æ³•
console.log('ä¸¤ä¸ªæœºå™¨äººæ˜¯å¦å…±äº«åŒä¸€ä¸ª sayHello æ–¹æ³•?', robotA.sayHello === robotB.sayHello); // è¾“å‡º true
```

### ğŸ” Level 3: å¯¹æ¯”å­¦ä¹ ï¼ˆé¿å…é™·é˜±ï¼‰
å¿˜è®° `new` å…³é”®å­—æ˜¯ä½¿ç”¨æ„é€ å‡½æ•°æ—¶æœ€å¸¸è§çš„é”™è¯¯ï¼Œè¿™ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„åæœã€‚

```javascript
function Spell(name, type) {
  this.name = name;
  this.type = type;
  console.log(`'this' åœ¨å‡½æ•°å†…éƒ¨æŒ‡å‘:`, this);
}

console.log("=== âŒ é”™è¯¯ç”¨æ³•: å¿˜è®°ä½¿ç”¨ new ===");
// å¦‚æœä¸ä½¿ç”¨ newï¼ŒSpell å°±åƒä¸€ä¸ªæ™®é€šå‡½æ•°è¢«è°ƒç”¨
// åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ'this' ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡ (åœ¨æµè§ˆå™¨ä¸­æ˜¯ window)
// è¿™ä¼šæ±¡æŸ“å…¨å±€ä½œç”¨åŸŸï¼
const fireball = Spell('ç«çƒæœ¯', 'ç«ç„°');
console.log('fireball çš„å€¼:', fireball); // undefined, å› ä¸ºå‡½æ•°æ²¡æœ‰æ˜¾å¼ return
// å°è¯•è®¿é—®å…¨å±€å˜é‡ï¼Œä½ ä¼šå‘ç°å®ƒä»¬è¢«æ„å¤–åˆ›å»ºäº†
// åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­å–æ¶ˆä¸‹é¢ä¸€è¡Œçš„æ³¨é‡Šä¼šçœ‹åˆ°ç»“æœ
// console.log('å…¨å±€å˜é‡ name:', window.name); // 'ç«çƒæœ¯'


console.log("\n=== âœ… æ­£ç¡®ç”¨æ³•: ä½¿ç”¨ new å…³é”®å­— ===");
// ä½¿ç”¨ new ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶å°† 'this' æŒ‡å‘å®ƒ
const iceBlast = new Spell('å¯’å†°ç®­', 'å†°éœœ');
console.log('iceBlast çš„å€¼:', iceBlast);
console.log(`åˆ›å»ºçš„æ³•æœ¯æ˜¯: ${iceBlast.name}ï¼Œå±äº ${iceBlast.type} ç³»ã€‚`);
```

### ğŸš€ Level 4: å®æˆ˜åº”ç”¨ï¼ˆçœŸå®åœºæ™¯ï¼‰
**åœºæ™¯ï¼šğŸ¾ è™šæ‹Ÿèµ›åšå® ç‰©å…»æˆ**

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªâ€œèµ›åšå® ç‰©â€æ„é€ å‡½æ•°ã€‚æ¯ä¸ªå® ç‰©éƒ½æœ‰è‡ªå·±çš„åå­—ã€ç±»å‹å’ŒçŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–¹æ³•ä¸å®ƒäº’åŠ¨ï¼Œæ¯”å¦‚å–‚é£Ÿå’Œç©è€ï¼Œè¿™äº›äº’åŠ¨ä¼šæ”¹å˜å®ƒçš„èƒ½é‡å’Œå¿«ä¹å€¼ã€‚

```javascript
// èµ›åšå® ç‰©æ„é€ å‡½æ•°
function CyberPet(name, type) {
  this.name = name;
  this.type = type; // ä¾‹å¦‚: 'ç”µå­ç‹—', 'åƒç´ çŒ«'
  this.energy = 100; // èƒ½é‡å€¼
  this.happiness = 100; // å¿«ä¹å€¼

  console.log(`âœ¨ å“‡ï¼ä¸€åªå«åš ${this.name} çš„ ${this.type} è¯ç”Ÿäº†ï¼`);
}

// åœ¨åŸå‹ä¸Šæ·»åŠ äº’åŠ¨æ–¹æ³•
CyberPet.prototype.play = function() {
  if (this.energy >= 20) {
    this.energy -= 20;
    this.happiness += 15;
    console.log(`ğŸ¾ ä½ å’Œ ${this.name} ç©äº†æ¿€å…‰ç¬”ï¼Œå®ƒçš„å¿«ä¹å€¼ä¸Šå‡äº†ï¼`);
  } else {
    console.log(`ğŸ’¤ ${this.name} å¤ªç´¯äº†ï¼Œä¸æƒ³ç©...`);
  }
  this.checkStatus();
};

CyberPet.prototype.feed = function() {
  this.energy += 30;
  this.happiness += 5;
  console.log(`ğŸ– ä½ å–‚äº† ${this.name} ä¸€å—èƒ½é‡æ–¹å—ï¼Œå®ƒçš„èƒ½é‡æ¢å¤äº†ï¼`);
  this.checkStatus();
};

CyberPet.prototype.checkStatus = function() {
  console.log(
    `--- ${this.name} çš„çŠ¶æ€ --- èƒ½é‡: ${this.energy}, å¿«ä¹: ${this.happiness} ---`
  );
};

// --- å¼€å§‹æ¸¸æˆ ---
// é¢†å…»ä¸€åªå® ç‰©
const myPet = new CyberPet('æ¯”ç‰¹', 'ç”µå­ç‹—');
myPet.checkStatus();

// å’Œå®ƒäº’åŠ¨
console.log('\n--- ä¸€å¤©è¿‡å»äº† ---');
myPet.play();
myPet.play();
myPet.feed();
myPet.play();
myPet.play();
myPet.play(); // èƒ½é‡ä¸è¶³
```

### ğŸ’¡ è®°å¿†è¦ç‚¹
-   **é¦–å­—æ¯å¤§å†™**ï¼šæ„é€ å‡½æ•°çš„åç§°é€šå¸¸ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¹¿æ³›éµå®ˆçš„çº¦å®šã€‚
-   **`new`æ˜¯å…³é”®**ï¼šå¿…é¡»ä½¿ç”¨ `new` å…³é”®å­—æ¥åˆ›å»ºå®ä¾‹ï¼Œå¦åˆ™ `this` çš„æŒ‡å‘ä¼šå‡ºé”™ã€‚
-   **`this`æŒ‡ä»£å®ä¾‹**ï¼šåœ¨æ„é€ å‡½æ•°å†…éƒ¨ï¼Œ`this` å…³é”®å­—æŒ‡å‘æ­£åœ¨è¢«åˆ›å»ºçš„æ–°å¯¹è±¡å®ä¾‹ã€‚

<!--
metadata:
  syntax: ["function", "constructor"]
  pattern: ["object-creation"]
  api: ["console.log"]
  concept: ["this-binding", "prototype", "instance"]
  difficulty: intermediate
  dependencies: ["æ— "]
  related: ["js-sec-4-1-2"]
-->