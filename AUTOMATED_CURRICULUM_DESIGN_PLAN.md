# 方案：构建结构感知的自动化课程设计系统

## 一、核心理念

本方案旨在解决自动化内容生成中的“上下文割裂”问题。核心理念是：**让AI首先理解知识的内在结构，然后根据不同的结构，采用不同的内容生成策略。** 我们将知识结构抽象为两种最核心的“原子构建块”：

1.  **流水线 (Pipeline):** 描述一个具有强时序性或依赖性的连续过程。
2.  **工具箱 (Toolbox):** 描述一组围绕共同主题但相对独立的方法或概念。

整个自动化流程将围绕“识别结构”和“应用策略”这两个核心展开。

## 二、端到端工作流 (四阶段)

我们将采用一个“分而治之”的四阶段工作流，每个阶段由一个专门的Agent负责。

### Stage 1: Brainstorm - 知识种子生成

*   **Agent:** 领域专家团
*   **任务:** 对给定主题进行发散性头脑风暴，生成大量无序但覆盖全面的知识点“种子”（seeds）。
*   **输出:** 一个包含许多知识点及其标签的JSON文件。

### Stage 2: Macro-Planning - 宏观路径规划

*   **Agent:** 宏观规划师 (Macro-Planner)
*   **任务:** 将无序的seeds组织成一个有序的、高级的章节列表，定义课程的宏观流水线。
*   **Prompt策略:** 使用带有“轻量级正反示例”的Prompt，指导AI进行逻辑排序和聚类。
*   **输出:** 一个有序的JSON数组，每个对象包含章节的`id`, `title`, 和 `objective`。

### Stage 3: Chapter Architecture - 章节微观设计

*   **Agent:** 章节架构师 (Chapter Architect)
*   **任务:** (在循环中)为每一个章节，设计其内部详细的微观结构。这是最关键的步骤，它将为每个小节（Group）和知识点（Section）注入结构化元数据。
*   **Prompt策略:** 使用包含完整高质量范例的**`one-shot` Prompt**。该Prompt明确定义了“流水线”和“工具箱”的概念，并要求AI为每个小节打上`structure_type`标签，为每个知识点打上`relation_to_previous`标签。
*   **输出:** 一个完整的、带有丰富元数据的JSON大纲。

### Stage 4: Content Direction - 结构感知的内容生成

*   **Agent:** 内容总监 (Content Director)
*   **任务:** 遍历最终大纲，根据每个小节的`structure_type`元数据，决定使用哪种策略来生成该小节下所有知识点的具体内容。
*   **Prompt策略 (双轨制):**

    1.  **如果 `structure_type` == `"toolbox"` (采用“静态模板系统”):**
        *   **策略:** 为每个知识点采用**“融合式Archetype Prompt”**。
        *   **构成:** 此Prompt由三部分组成：
            1.  **情景上下文:** 根据`relation_to_previous`元数据动态生成的“承上启下”引导语。
            2.  **核心内容指令:** 从`archetype`模板中提炼出的核心“写作要点清单”。
            3.  **融合指令:** 命令AI将前两者无缝结合，确保叙事连贯。
        *   **特点:** 此方法保证了每个“工具”的讲解都遵循一个全面、高质量的标准化结构，同时又融入了上下文，避免孤立。

    2.  **如果 `structure_type` == `"pipeline"` (采用“动态模块系统”):**
        *   **策略:** 为每个知识点采用**“带约束的柔性Prompt”**，完全抛弃固定的`archetype`和`switches`体系。
        *   **构成:** 此Prompt由四部分组成：
            1.  **情景上下文:** 动态生成的引导语，定位当前步骤在流水线中的位置。
            2.  **核心任务:** 一个高度聚焦的、角色化的任务指令（如“讲解第一步”、“对比优劣”）。
            3.  **建议内容模块清单:** 一个给予AI的“工具箱”，包含`code_example`, `common_mistake`, `analogy`等模块。AI被指示**根据当前步骤的教学需要，自主判断、酌情选用**一到两个模块融入内容，而非全部使用。
            4.  **融合指令:** 命令AI将所有部分自然地融合成一篇行文流畅的教学内容。
        *   **特点:** 此方法在保证流水线叙事连贯性的同时，通过“内容模块清单”确保了每个步骤内容的质量和深度下限，并避免了在每个步骤都重复讲述相同要素（如“原理”、“误区”）的冗余问题。

## 三、总结

该四阶段方案通过逐级细化、分而治之的策略，构建了一个能够理解并利用知识内在结构的先进内容生成系统。它最终的成功，依赖于在**大纲层面（Stage 3）精确地识别和标注结构**，然后在**内容生成层面（Stage 4）智能地应用不同的、与之匹配的生成策略**，从而从根本上解决了自动化内容的“割裂感”问题，实现了真正的“叙事连贯”。
